<component name="ca.firstvoices.schemas.registration.contrib">

  	<require>org.nuxeo.ecm.user.registration.lifecycle.contrib</require>
  	<require>org.nuxeo.ecm.user.registration.core.types.contrib</require>

	<extension target="org.nuxeo.ecm.core.schema.TypeService" point="schema">
		<schema name="user" override="true" src="schemas/fvuser.xsd" />
		<schema name="fvuserinfo" src="schemas/fvuserinfo.xsd" prefix="fvuserinfo" />
	</extension>
	
	<extension target="org.nuxeo.ecm.core.schema.TypeService" point="doctype">
	
	   <!-- <doctype name="FVUser" extends="Picture">
	     <schema name="userinfo"/>
	     <schema name="fvuser"/>
	   </doctype> -->
	   
	   <doctype name="FVUserRegistration" extends="UserRegistration">
	     <schema name="fvuserinfo"/>
	     <facet>Versionable</facet>
	     <facet>HiddenInNavigation</facet>
	     <facet>Publishable</facet>
	     <facet>Commentable</facet>
	     <facet>HasRelatedText</facet>
	     <facet>UserRegistration</facet>
	   </doctype>
	   
	</extension>
	
	<extension target="org.nuxeo.ecm.core.lifecycle.LifeCycleService" point="types">
	    <types>
	      <type name="FVUserRegistration">registrationRequest</type>
	    </types>
	</extension>
  
	<extension target="org.nuxeo.ecm.user.registration.UserRegistrationService"
	    point="configuration">
	    <configuration merge="true">
	        <requestDocType>FVUserRegistration</requestDocType>
	        <userInfo>
	          <schemaName>userinfo</schemaName>
	          <usernameField>userinfo:login</usernameField>
	          <emailField>userinfo:email</emailField>
	          <firstnameField>userinfo:firstName</firstnameField>
	          <lastnameField>userinfo:lastName</lastnameField>
	          <groupsField>userinfo:groups</groupsField>
	          <companyField>userinfo:company</companyField>
	        </userInfo>
			<validationEmail>
				<title>You are invited to access FirstVoices</title>
				<template>skin/views/FVEmailInviteDocTemplate.ftl</template>
			</validationEmail>
			<reviveEmail>
			  <title>You are invited to access FirstVoices</title>
			  <template>skin/views/FVReviveEmailInviteDocTemplate.ftl</template>
			</reviveEmail>
			<enterPasswordUrl>site/userRegistration/enterpassword/</enterPasswordUrl>
			<validationRelUrl>site/userRegistration/validate</validationRelUrl>
	    </configuration>
	</extension>
  
</component>
